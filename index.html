<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>çŒ®ç«‹å…±æœ‰ã‚¢ãƒ—ãƒª</title>
  <style>
    body { font-family: sans-serif; padding: 1em; }
    .tab { display: inline-block; margin: 0 1em; padding: 0.5em 1em; background: #eee; border: 1px solid #ccc; border-radius: 4px; cursor: pointer; }
    .tab.active { background: #4285f4; color: #fff; border-color: #4285f4; }
    .section { margin-top: 1em; display: none; }
    .section.active { display: block; }
  </style>
</head>
<body>

<h1>çŒ®ç«‹å…±æœ‰ã‚¢ãƒ—ãƒª</h1>

<div>
  <span class="tab active" data-tab="main">ä¸»èœ</span>
  <span class="tab" data-tab="side">å‰¯èœ</span>
  <span class="tab" data-tab="soup">æ±ç‰©</span>
</div>
<div id="main" class="section active"><ul id="mainList"></ul></div>
<div id="side" class="section"><ul id="sideList"></ul></div>
<div id="soup" class="section"><ul id="soupList"></ul></div>

<h3>æ–°è¦ãƒ¬ã‚·ãƒ”</h3>
<select id="category"><option value="main">ä¸»èœ</option><option value="side">å‰¯èœ</option><option value="soup">æ±ç‰©</option></select>
<input id="dishName" placeholder="æ–™ç†å">
<input id="ingredients" placeholder="é£Ÿæï¼ˆã‚«ãƒ³ãƒåŒºåˆ‡ã‚Šï¼‰">
<button onclick="addRecipe()">è¿½åŠ </button>

<h3>çŒ®ç«‹ç”Ÿæˆ</h3>
<button onclick="generatePlan(3)">3æ—¥é–“</button>
<button onclick="generatePlan(7)">1é€±é–“</button>
<div id="generatedPlan"></div>

<h3>è²·ã„ç‰©ãƒªã‚¹ãƒˆ</h3>
<ul id="shoppingList"></ul>
<button onclick="restoreItems()">å¾©å…ƒ</button>

<script>
let mainDishes = [{ name: "é¶ã®ç…§ã‚Šç„¼ã", ingredients: ["é¶ã‚‚ã‚‚è‚‰", "ã—ã‚‡ã†ã‚†", "ã¿ã‚Šã‚“"] }, { name: "ãƒãƒ³ãƒãƒ¼ã‚°", ingredients: ["åˆã„ã³ãè‚‰", "ç‰ã­ã", "ãƒ‘ãƒ³ç²‰"] }];
let sideDishes = [{ name: "ã»ã†ã‚Œã‚“è‰ã®ãŠã²ãŸã—", ingredients: ["ã»ã†ã‚Œã‚“è‰", "ã—ã‚‡ã†ã‚†"] }];
let soupDishes = [{ name: "å‘³å™Œæ±", ingredients: ["å‘³å™Œ", "è±†è…", "ã‚ã‹ã‚"] }];
let shoppingList = new Set();
let deletedItems = [];

function addRecipe() {
  const cat = document.getElementById('category').value;
  const name = document.getElementById('dishName').value.trim();
  const ing = document.getElementById('ingredients').value.split(',').map(i => i.trim()).filter(i => i);
  if (!name || ing.length === 0) return;
  if (cat === 'main') mainDishes.push({ name, ingredients: ing });
  if (cat === 'side') sideDishes.push({ name, ingredients: ing });
  if (cat === 'soup') soupDishes.push({ name, ingredients: ing });
  renderRecipes(cat);
}

function renderRecipes(cat) {
  const lists = { main: mainDishes, side: sideDishes, soup: soupDishes };
  const listEl = document.getElementById(cat + 'List');
  listEl.innerHTML = '';
  lists[cat].forEach((d, i) => {
    const li = document.createElement('li');
    li.textContent = `${d.name} - ${d.ingredients.join(', ')}`;
    const edit = document.createElement('button');
    edit.textContent = 'âœï¸';
    edit.onclick = () => {
      const newName = prompt('æ–°ã—ã„åå‰', d.name);
      const newIngredients = prompt('æ–°ã—ã„é£Ÿæï¼ˆã‚«ãƒ³ãƒåŒºåˆ‡ã‚Šï¼‰', d.ingredients.join(', '));
      if (newName && newIngredients) {
        d.name = newName.trim();
        d.ingredients = newIngredients.split(',').map(x => x.trim()).filter(x => x);
        renderRecipes(cat);
      }
    };
    const del = document.createElement('button');
    del.textContent = 'ğŸ—‘ï¸';
    del.onclick = () => {
      lists[cat].splice(i, 1);
      renderRecipes(cat);
    };
    li.appendChild(edit);
    li.appendChild(del);
    listEl.appendChild(li);
  });
}

document.querySelectorAll('.tab').forEach(tab => {
  tab.onclick = () => {
    document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
    document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
    tab.classList.add('active');
    document.getElementById(tab.dataset.tab).classList.add('active');
    renderRecipes(tab.dataset.tab);
  };
});

function generatePlan(days) {
  const out = document.getElementById('generatedPlan');
  out.innerHTML = '';
  shoppingList.clear();
  deletedItems = [];
  for (let i = 0; i < days; i++) {
    const m = mainDishes[Math.floor(Math.random() * mainDishes.length)];
    const div = document.createElement('div');
    div.innerHTML = `<b>${i + 1}æ—¥ç›®:</b> ${m.name}`;
    m.ingredients.forEach(i => shoppingList.add(i));

    const s = document.createElement('select');
    s.innerHTML = `<option>å‰¯èœã‚’è¿½åŠ </option>`;
    sideDishes.forEach(sd => { let o = document.createElement('option'); o.textContent = sd.name; s.appendChild(o); });
    s.onchange = () => {
      if (s.value !== 'å‰¯èœã‚’è¿½åŠ ') {
        const f = sideDishes.find(x => x.name === s.value);
        f.ingredients.forEach(i => shoppingList.add(i));
        renderShopping();
      }
    };

    const so = document.createElement('select');
    so.innerHTML = `<option>æ±ç‰©ã‚’è¿½åŠ </option>`;
    soupDishes.forEach(sd => { let o = document.createElement('option'); o.textContent = sd.name; so.appendChild(o); });
    so.onchange = () => {
      if (so.value !== 'æ±ç‰©ã‚’è¿½åŠ ') {
        const f = soupDishes.find(x => x.name === so.value);
        f.ingredients.forEach(i => shoppingList.add(i));
        renderShopping();
      }
    };

    div.appendChild(s);
    div.appendChild(so);
    out.appendChild(div);
  }
  renderShopping();
}

function renderShopping() {
  const list = document.getElementById('shoppingList');
  list.innerHTML = '';
  shoppingList.forEach(i => {
    const li = document.createElement('li');
    li.textContent = i + ' ';
    const btn = document.createElement('button');
    btn.textContent = 'ğŸ—‘ï¸';
    btn.onclick = () => {
      shoppingList.delete(i);
      deletedItems.push(i);
      renderShopping();
    };
    li.appendChild(btn);
    list.appendChild(li);
  });
}

function restoreItems() {
  deletedItems.forEach(i => shoppingList.add(i));
  deletedItems = [];
  renderShopping();
}

renderRecipes('main');
</script>

</body>
</html>
